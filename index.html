<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>For My Jainu üåπ</title>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Cinzel:wght@400;700&family=Montserrat:wght@300;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-color: #000000;
            --rose-red: #e53935;
            --soft-pink: #ff8a80;
            --glass: rgba(255, 255, 255, 0.05);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body {
            background-color: var(--bg-color);
            color: #fff;
            font-family: 'Montserrat', sans-serif;
            overflow: hidden;
            height: 100vh;
            width: 100vw;
            position: fixed;
        }

        #star-canvas, #falling-roses-canvas { position: fixed; inset: 0; pointer-events: none; z-index: 1; }
        #falling-roses-canvas { z-index: 2; opacity: 0; transition: opacity 3s; }

        /* --- INTRO SCREEN --- */
        #volume-screen {
            position: fixed; inset: 0; background: #000; z-index: 10000;
            display: flex; flex-direction: column; justify-content: center;
            align-items: center; text-align: center; padding: 20px;
            transition: transform 1.5s cubic-bezier(0.85, 0, 0.15, 1);
        }

        .volume-card {
            background: var(--glass);
            border: 1px solid rgba(229, 57, 53, 0.3);
            padding: 30px 20px;
            border-radius: 30px;
            backdrop-filter: blur(10px);
            max-width: 400px; width: 100%;
            box-shadow: 0 20px 50px rgba(0,0,0,0.8);
        }

        .volume-icon { font-size: 4rem; margin-bottom: 15px; filter: drop-shadow(0 0 20px var(--rose-red)); animation: pulse 3s infinite; }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.05); opacity: 0.8; }
        }

        .fucchi-msg {
            font-family: 'Dancing Script', cursive;
            font-size: 1.3rem;
            color: #eee;
            margin-bottom: 20px;
            line-height: 1.4;
        }

        .race-bar-container {
            width: 100%; height: 6px; background: rgba(255,255,255,0.1); border-radius: 10px;
            margin: 20px 0; overflow: hidden;
        }
        .race-bar-fill { width: 0%; height: 100%; background: var(--rose-red); box-shadow: 0 0 15px var(--rose-red); transition: width 0.5s linear; }

        /* --- HEART SCREEN --- */
        #heart-screen {
            position: fixed; inset: 0; background: #000; display: none;
            flex-direction: column; justify-content: center; align-items: center;
            z-index: 5000; opacity: 0; transition: opacity 1.5s;
        }

        .heart-container {
            position: relative; width: 120px; height: 120px; cursor: pointer;
            filter: drop-shadow(0 0 30px var(--rose-red));
            animation: slow-heartbeat 2.5s infinite ease-in-out;
        }

        @keyframes slow-heartbeat {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.08); }
        }

        .heart-shape {
            position: absolute; inset: 0; background-color: var(--rose-red); transform: rotate(-45deg);
        }
        .heart-shape:before, .heart-shape:after {
            content: ""; position: absolute; background-color: var(--rose-red);
            border-radius: 50%; width: 100%; height: 100%;
        }
        .heart-shape:before { top: -50%; left: 0; }
        .heart-shape:after { top: 0; right: -50%; }

        /* --- SPACE SCREEN --- */
        #space-screen { display: none; position: relative; width: 100%; height: 100%; opacity: 0; transition: opacity 2.5s; z-index: 5;}

        .floating-rose {
            position: absolute; font-size: 3rem; cursor: pointer;
            filter: drop-shadow(0 0 15px var(--rose-red)); z-index: 10; 
            user-select: none; will-change: transform;
        }

        .pop-out { animation: burst 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards; }
        @keyframes burst {
            0% { transform: scale(1); opacity: 1; }
            100% { transform: scale(2.5); opacity: 0; }
        }

        .narrative-box {
            position: absolute; top: 15px; left: 50%; transform: translateX(-50%);
            width: 90%; max-width: 600px; text-align: center; z-index: 20;
            padding: 12px; background: rgba(0,0,0,0.85); border-radius: 20px;
            backdrop-filter: blur(8px); border: 1px solid rgba(229,57,53,0.3);
        }

        .narrative-text {
            font-family: 'Dancing Script', cursive; font-size: 1.15rem; color: #ffccd5;
            line-height: 1.4;
        }

        /* --- MODAL --- */
        .modal {
            position: fixed; inset: 0; background: rgba(0,0,0,0.98);
            display: none; justify-content: center; align-items: center;
            z-index: 20000; padding: 10px;
        }
        .modal-content {
            background: #000; padding: 8px; border-radius: 20px;
            border: 1px solid rgba(229, 57, 53, 0.5); text-align: center;
            max-width: 500px; width: 100%; box-shadow: 0 0 50px rgba(229, 57, 53, 0.2);
        }
        .modal-img {
            width: 100%; max-height: 75vh; object-fit: contain;
            border-radius: 12px; background: #050505; 
        }

        /* --- FINAL SCREEN --- */
        #finale-screen {
            display: none; flex-direction: column; justify-content: space-between;
            align-items: center; height: 100%; text-align: center; opacity: 0;
            padding: 40px 20px; z-index: 10;
        }

        .finale-top {
            display: flex; flex-direction: column; align-items: center;
            margin-top: 10px;
        }

        .giant-emoji-rose {
            font-size: clamp(5rem, 15vh, 7rem); margin-bottom: 10px;
            filter: drop-shadow(0 0 30px var(--rose-red));
            animation: float-rose 4.5s ease-in-out infinite;
        }

        @keyframes float-rose {
            0%, 100% { transform: translateY(0) rotate(0); }
            50% { transform: translateY(-15px) rotate(5deg); }
        }

        .finale-titles {
            margin-top: 5px;
            border-top: 1px solid rgba(255,255,255,0.1);
            border-bottom: 1px solid rgba(255,255,255,0.1);
            padding: 10px 0;
            width: 100%;
        }

        .finale-title { font-family:'Dancing Script'; font-size: 2.4rem; color:var(--soft-pink); margin-bottom: 5px; text-shadow: 0 0 10px rgba(255,138,128,0.5); }
        .finale-subtitle { font-family:'Cinzel'; color:var(--rose-red); font-size: 1.2rem; letter-spacing: 2px; }

        .finale-middle {
            flex-grow: 1; display: flex; align-items: center; justify-content: center;
            padding: 20px 0;
        }

        .finale-desc { 
            font-family:'Dancing Script'; max-width:420px; color:#fff; 
            line-height: 1.5; font-size: 1.3rem;
            padding: 20px;
            background: rgba(229, 57, 53, 0.05);
            border-radius: 20px;
        }

        .btn-main {
            background: var(--rose-red); border: none;
            color: #fff; padding: 12px 35px; font-family: 'Cinzel', serif;
            font-weight: 700; border-radius: 50px; cursor: pointer;
            transition: 0.4s; letter-spacing: 2px;
            font-size: 0.9rem;
            box-shadow: 0 5px 15px rgba(229, 57, 53, 0.3);
        }
        .btn-main:hover { transform: scale(1.05); box-shadow: 0 0 25px var(--rose-red); }

        #audio-status { font-size: 0.7rem; margin-top: 10px; color: #666; }

    </style>
</head>
<body>

    <canvas id="star-canvas"></canvas>
    <canvas id="falling-roses-canvas"></canvas>

    <!-- Music file linked as requested -->
    <audio id="bgMusic" loop preload="auto">
        <source src="Navjot_Ahuja_-_Khat__Official_Audio_(256k).mp3" type="audio/mpeg">
    </audio>

    <div id="volume-screen">
        <div class="volume-card">
            <div class="volume-icon">‚ù§Ô∏è</div>
            <p class="fucchi-msg">I made this for you, Jainu. Turn up the volume, take a breath, and enjoy the memories... ‚ù§Ô∏è</p>
            <div class="race-bar-container"><div class="race-bar-fill" id="raceFill"></div></div>
            <button class="btn-main" id="startBtn">START THE MAGIC</button>
            <p id="audio-status">Wait for the melody... üéµ</p>
        </div>
    </div>

    <div id="heart-screen">
        <div class="heart-container" id="heartTrigger"><div class="heart-shape"></div></div>
        <h2 style="font-family:'Dancing Script'; font-size: 1.8rem; margin-top: 30px; color: #ffccd5;">Open My Heart...</h2>
    </div>

    <div id="space-screen">
        <div class="narrative-box">
            <p class="narrative-text" id="spaceStory">
                Collect these roses, Jenishi. Each one is a piece of my heart just for you. üòÇ‚ù§Ô∏è
            </p>
            <p style="font-size: 0.7rem; margin-top: 5px; color: var(--rose-red); opacity: 0.7;">
                Tap slowly to relive each memory
            </p>
        </div>
        <div id="roseContainer" style="width:100%; height:100%;"></div>
    </div>

    <div class="modal" id="photoModal">
        <div class="modal-content">
            <div id="loadingText" style="color: var(--rose-red); margin-bottom: 5px; font-size: 0.8rem;">Feeling the moment...</div>
            <img id="modalImg" src="" class="modal-img">
            <p id="modalMsg" style="font-family:'Dancing Script'; font-size:1.2rem; margin: 8px 0; color: #ffccd5;"></p>
            <button class="btn-main" style="padding: 10px 25px; font-size: 0.8rem;" onclick="closeModal()">Back to my heart üåπ</button>
        </div>
    </div>

    <div id="finale-screen">
        <div class="finale-top">
            <div class="giant-emoji-rose">üåπ</div>
            <div class="finale-titles">
                <h1 class="finale-title">Happy Rose Day</h1>
                <h2 class="finale-subtitle">Meri Pyari Jainu</h2>
            </div>
        </div>

        <div class="finale-middle">
            <p class="finale-desc">
                "Every rose you found is a memory I hold dear. You're the most beautiful flower in my life's garden. Happy Rose Day, my favorite person."
            </p>
        </div>

        <div class="finale-bottom">
            <button class="btn-main" onclick="location.reload()" style="margin-bottom: 30px;">REPLAY THE MAGIC ‚ù§Ô∏è</button>
        </div>
    </div>

    <script>
        const audio = document.getElementById('bgMusic');
        const audioStatus = document.getElementById('audio-status');
        audio.volume = 0.8;

        audio.oncanplaythrough = () => {
            audioStatus.innerText = "Khat is ready. Tap to start. üåπ";
            audioStatus.style.color = "#e53935";
        };

        audio.onerror = () => {
            audioStatus.innerText = "Music ready (Khat)! Tap to start. üåπ";
        };

        let rosesCollected = 0;
        let animationId;
        const roseObjects = [];
        const ROSE_SIZE = 55; 

        const canvas = document.getElementById('star-canvas');
        const ctx = canvas.getContext('2d');
        let stars = [];

        const roseCanvas = document.getElementById('falling-roses-canvas');
        const roseCtx = roseCanvas.getContext('2d');
        let fallingRoses = [];

        function resizeCanvas() {
            canvas.width = roseCanvas.width = window.innerWidth;
            canvas.height = roseCanvas.height = window.innerHeight;
        }
        window.addEventListener('resize', resizeCanvas);
        resizeCanvas();

        class Star {
            constructor() { this.reset(); }
            reset() {
                this.x = Math.random() * canvas.width;
                this.y = Math.random() * canvas.height;
                this.size = Math.random() * 1.5;
                this.speed = (Math.random() * 0.15) + 0.05;
                this.alpha = Math.random();
                this.fadeSpeed = Math.random() * 0.005;
            }
            update() {
                this.y += this.speed;
                this.alpha += this.fadeSpeed;
                if (this.alpha > 1 || this.alpha < 0) this.fadeSpeed *= -1;
                if (this.y > canvas.height) this.y = -10;
            }
            draw() {
                ctx.fillStyle = `rgba(255, 255, 255, ${Math.abs(this.alpha)})`;
                ctx.beginPath(); ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2); ctx.fill();
            }
        }

        class FallingRose {
            constructor() {
                this.x = Math.random() * roseCanvas.width;
                this.y = -50 - (Math.random() * 500);
                this.size = 18 + Math.random() * 22;
                this.speed = 0.5 + Math.random() * 0.8;
                this.rotation = Math.random() * 360;
                this.rotSpeed = (Math.random() - 0.5) * 0.8;
                this.swing = Math.random() * 1.2;
                this.swingSpeed = 0.01 + Math.random() * 0.02;
                this.swingOffset = Math.random() * Math.PI * 2;
            }
            update() {
                this.y += this.speed;
                this.rotation += this.rotSpeed;
                this.x += Math.sin(this.y * this.swingSpeed + this.swingOffset) * this.swing;
                if (this.y > roseCanvas.height + 50) {
                    this.y = -50;
                    this.x = Math.random() * roseCanvas.width;
                }
            }
            draw() {
                roseCtx.save();
                roseCtx.translate(this.x, this.y);
                roseCtx.rotate(this.rotation * Math.PI / 180);
                roseCtx.font = `${this.size}px serif`;
                roseCtx.textAlign = 'center';
                roseCtx.textBaseline = 'middle';
                roseCtx.fillText('üåπ', 0, 0);
                roseCtx.restore();
            }
        }

        for (let i = 0; i < 60; i++) stars.push(new Star());
        for (let i = 0; i < 25; i++) fallingRoses.push(new FallingRose());

        function animateGlobal() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            stars.forEach(s => { s.update(); s.draw(); });
            
            if (roseCanvas.style.opacity === '1') {
                roseCtx.clearRect(0, 0, roseCanvas.width, roseCanvas.height);
                fallingRoses.forEach(r => { r.update(); r.draw(); });
            }
            requestAnimationFrame(animateGlobal);
        }
        animateGlobal();

        const getUrl = (id) => `https://lh3.googleusercontent.com/d/${id}=w1000?authuser=0`;

        const memories = [
            { msg: "You In This Black Sari - Ufff üò≠üò≠üò≠‚ù§Ô∏è", id: "1PUkoWK10lRIhL4CpS75SP2miiQTUZG64" },
            { msg: "This Smile ‚ù§Ô∏è", id: "1RfiryDNKE-6sTupJgEJVLFF4gAcvxRIk" },
            { msg: "Daari Wali Jaini", id: "1vnV7osGu1gzL2ebiwyKlPWi6ZmPnnYAu" },
            { msg: "Our First Pic In School Dress", id: "1lGlND0dC50eEaEPpObPPiN9Ywru_CkPy" },
            { msg: "Hamro Peace Treaty üòÇüò≠‚ù§Ô∏è", id: "1EFp_Xrz95XayoY9dZkGtSAz1nohBwXXw" },
            { msg: "Us At Manakamana", id: "1pFBAhzjbvVUU2bp9RcbA7YF90GsxdlKA" },
            { msg: "The Day Hamare Ghar Wale Chining Uh üôÇ‚ù§Ô∏è", id: "1N-32gSkueiP6bIeEjpROWzJ5kfEUU2wp" },
            { msg: "Bigrya Phone Ma K Herdai Ho KhaiiiüôÇ", id: "1EHKZYct1YEwCbCU958eOHVUfBNTnnkJV" },
            { msg: "Us In Cultural", id: "1CcAgAfjM5jIz6kDFRUMd5e28l8C0g3J0" },
            { msg: "Dameyyy Ko Narzo 30 Bata Leko Pic", id: "1HJw25QSGXgmsbZHzw6InXyKhe8CZnxJs" },
            { msg: "Oyeee Ko Ho Yo..?? üòÇ‚ù§Ô∏è", id: "1aXo3TKs4O6CaO-fhkRAgqYRHeVjp2lV4" },
            { msg: "Heart Bananeki Kosish‚ù§Ô∏è", id: "1AqZehA_mTBpQnI6nfonWwJ-JKyIaCm2J" },
            { msg: "Current Us Ekdam Babal‚ù§Ô∏è", id: "1aCt8BTCc-K8TBUFesP47y6chWHtY4AWD" }
        ];

        document.getElementById('startBtn').onclick = function() {
            audio.play().catch(e => console.log("Music play attempt", e));
            this.style.display = 'none';
            const fill = document.getElementById('raceFill');
            let width = 0;
            const interval = setInterval(() => {
                width += 1; fill.style.width = width + '%';
                if(width >= 100) { clearInterval(interval); transitionToHeart(); }
            }, 50);
        };

        function transitionToHeart() {
            document.getElementById('volume-screen').style.transform = 'translateY(-100%)';
            const heartScreen = document.getElementById('heart-screen');
            heartScreen.style.display = 'flex';
            setTimeout(() => heartScreen.style.opacity = '1', 100);
        }

        document.getElementById('heartTrigger').onclick = function() {
            if (audio.paused) audio.play().catch(() => {});
            explodeHeart();
        };

        function explodeHeart() {
            const heart = document.querySelector('.heart-container');
            heart.style.transition = '0.8s ease-in'; heart.style.transform = 'scale(50)'; heart.style.opacity = '0';
            setTimeout(() => { document.getElementById('heart-screen').style.display = 'none'; initSpace(); }, 700);
        }

        class Rose {
            constructor(index) {
                this.index = index;
                this.element = document.createElement('div');
                this.element.className = 'floating-rose';
                this.element.innerHTML = 'üåπ';
                this.radius = ROSE_SIZE / 2;
                this.x = Math.random() * (window.innerWidth - ROSE_SIZE);
                this.y = 120 + Math.random() * (window.innerHeight - 200);
                this.vx = (Math.random() - 0.5) * 0.8;
                this.vy = (Math.random() - 0.5) * 0.8;
                this.isPopped = false;
                this.element.onclick = () => this.pop();
                document.getElementById('roseContainer').appendChild(this.element);
            }
            update() {
                if (this.isPopped) return;
                this.x += this.vx; this.y += this.vy;
                if (this.x <= 0 || this.x >= window.innerWidth - ROSE_SIZE) this.vx *= -1;
                if (this.y <= 110 || this.y >= window.innerHeight - ROSE_SIZE) this.vy *= -1;
                this.element.style.transform = `translate(${this.x}px, ${this.y}px)`;
            }
            pop() {
                if (this.isPopped) return;
                if (audio.paused) audio.play().catch(() => {});
                this.isPopped = true;
                this.element.classList.add('pop-out');
                setTimeout(() => { this.element.style.display = 'none'; showModal(this.index); }, 550);
            }
        }

        function initSpace() {
            document.getElementById('space-screen').style.display = 'block';
            setTimeout(() => document.getElementById('space-screen').style.opacity = '1', 100);
            memories.forEach((_, i) => roseObjects.push(new Rose(i)));
            animateRoses();
        }

        function animateRoses() {
            roseObjects.forEach(rose => {
                rose.update();
                roseObjects.forEach(other => {
                    if (rose === other || rose.isPopped || other.isPopped) return;
                    const dx = (rose.x + rose.radius) - (other.x + other.radius);
                    const dy = (rose.y + rose.radius) - (other.y + other.radius);
                    const distance = Math.sqrt(dx * dx + dy * dy);
                    if (distance < ROSE_SIZE) {
                        const angle = Math.atan2(dy, dx);
                        const cos = Math.cos(angle);
                        const sin = Math.sin(angle);
                        let tx = rose.vx; let ty = rose.vy;
                        rose.vx = other.vx; rose.vy = other.vy;
                        other.vx = tx; other.vy = ty;
                        const overlap = ROSE_SIZE - distance;
                        rose.x += cos * (overlap / 2); rose.y += sin * (overlap / 2);
                        other.x -= cos * (overlap / 2); other.y -= sin * (overlap / 2);
                    }
                });
            });
            animationId = requestAnimationFrame(animateRoses);
        }

        function showModal(index) {
            cancelAnimationFrame(animationId);
            const modal = document.getElementById('photoModal');
            const imgEl = document.getElementById('modalImg');
            imgEl.style.opacity = '0';
            imgEl.src = getUrl(memories[index].id);
            document.getElementById('modalMsg').innerText = memories[index].msg;
            imgEl.onload = () => {
                document.getElementById('loadingText').style.display = 'none';
                imgEl.style.opacity = '1';
                imgEl.style.transition = 'opacity 0.8s';
            };
            modal.style.display = 'flex';
        }

        function closeModal() {
            document.getElementById('photoModal').style.display = 'none';
            document.getElementById('loadingText').style.display = 'block';
            rosesCollected++;
            if(rosesCollected === memories.length) showFinale();
            else animateRoses();
        }

        function showFinale() {
            cancelAnimationFrame(animationId);
            document.getElementById('space-screen').style.opacity = '0';
            setTimeout(() => {
                document.getElementById('space-screen').style.display = 'none';
                const finale = document.getElementById('finale-screen');
                finale.style.display = 'flex';
                roseCanvas.style.opacity = '1'; 
                setTimeout(() => finale.style.opacity = '1', 200);
            }, 1000);
        }
    </script>
</body>
</html>

